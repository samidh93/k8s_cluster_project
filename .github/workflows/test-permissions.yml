name: Test GitHub Actions Permissions

on:
  workflow_dispatch:  # Manual trigger only
  push:
    branches: [ main ]
    paths:
      - 'test-permissions.txt'  # Only trigger when this file changes

jobs:
  test-permissions:
    name: ğŸ” Test Write Permissions
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
        
    - name: Test File Creation
      run: |
        echo "ğŸ§ª Testing GitHub Actions write permissions..."
        echo "Current timestamp: $(date)" > test-permissions.txt
        echo "âœ… Test file created successfully!"
        
    - name: Test Git Add
      run: |
        echo "ğŸ“ Testing git add..."
        git add test-permissions.txt
        echo "âœ… Git add successful!"
        
    - name: Test Git Commit
      run: |
        echo "ğŸ’¾ Testing git commit..."
        git config --local user.email "action@github.com"
        git config --local user.name "GitHub Action"
        git commit -m "Test: Verify GitHub Actions write permissions [skip ci]"
        echo "âœ… Git commit successful!"
        
    - name: Test Git Push
      run: |
        echo "ğŸ“¤ Testing git push..."
        git push origin main
        echo "âœ… Git push successful!"
        
    - name: Success Message
      run: |
        echo "ğŸ‰ All permission tests passed!"
        echo "GitHub Actions has write access to the repository"
        echo "The main CI/CD workflow should work correctly now"
